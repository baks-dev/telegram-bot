{% trans_default_domain 'telegram.bot' %}

<div class="modal-dialog modal-dialog-centered" style="max-width: 800px;">
    {{ form_start(form) }}
    <div class="modal-content p-3 border-bottom border-5 border-primary">
        <div class="modal-header">

            <h5 class="modal-title">
                {# Заголовок модального окна #}
                {{ 'admin.breadcrumb.settings'|trans }}

            </h5>

            <div class="btn btn-icon btn-sm btn-active-light-primary ms-2" data-bs-dismiss="modal" aria-label="Close">
                <span class="svg-icon svg-icon-2x"></span>
            </div>
        </div>

        <div class="modal-body">

            {{ form_row(form.url, {label: 'Ссылка на Telegram Bot'}) }}

            {{ form_row(form.token, {label: 'Токен авторизации'}) }}

            {{ form_row(form.secret, {
                label: 'Ключ проверки подлиности запроса',
                help: 'Допускаются только символы A-Z, a-z, 0-9, _ и -'
            }) }}

            <div class="alert alert-danger d-flex align-items-center" role="alert">
                <div>
                    Токен авторизации и Ключ проверки подлиности запроса не отображается при редактировании
                </div>
            </div>

            {{ form_row(form.connect,{
                label: 'Количество одновременных подключений',
                help: 'По умолчанию 50. Используйте более низкие значения, чтобы ограничить нагрузку на сервер, и более высокие значения, чтобы увеличить пропускную способность.'
            }) }}


            {# Сообщения #}

            <div class="card w-100 border-light">
                <div class="card-body pb-0" id="collection-message">

                    <div class="d-flex justify-content-between gap-3 mb-3">
                        <div class="w-100 fw-bold">Сообщения</div>
                    </div>
                    {% for message_count, form in form.message %}
                        <div class='mb-3 item-message' id='item_{{ form.vars.id }}'>
                            {{ include(_self|replace({ "_form.html.twig": "/message/_message.html.twig" })) }}
                        </div>
                    {% endfor %}
                </div>
            </div>

            <div class="card-footer border-light bg-body d-flex justify-content-between align-items-center">
                <button
                        type="button"
                        id="messageAddCollection"
                        class="btn btn-sm btn-outline-primary border-0 message-add-collection"
                        data-prototype="{{ include(_self|replace({ "_form.html.twig": "message/_message.prototype.html.twig" }))|e('html_attr') }}"

                        data-collection="{{ form.message.vars.id }}-collection"
                        data-index="{{ form.message.count }}"
                        data-message="{{ form.message.vars.name }}"
                >

                    <span class="svg-icon svg-icon-2">
							<svg xmlns="http://www.w3.org/2000/svg"
                                 width="24"
                                 height="24"
                                 viewBox="0 0 24 24"
                                 fill="none">
								<rect opacity="0.5"
                                      x="11"
                                      y="18"
                                      width="12"
                                      height="2"
                                      rx="1"
                                      transform="rotate(-90 11 18)"
                                      fill="currentColor">
							</rect>
								<rect x="6" y="11" width="12" height="2" rx="1" fill="currentColor"></rect>
							</svg>
						</span>
                    Добавить еще сообщение
                </button>
            </div>


        </div>

        <div class="modal-footer">

            <div class="flex-grow-1">
                &nbsp;
            </div>

            <div class="d-flex gap-3">
                {# Отмена #}

                <button type="button" class="btn btn-light" data-bs-dismiss="modal">
                    {{ 'btn.cancel'|trans({}, 'core.btn') }}
                </button>


                {# Удалить #}
                {{ form_widget(form.telegram_bot_settings, { label: '
                    <span>'~ 'btn.save'|trans({}, 'core.btn') ~'</span>
                    <span class="spinner-border spinner-border-sm vertical-middle d-none"></span>
                '}) }}
            </div>
        </div>
    </div>
    {{ form_end(form) }}
</div>
